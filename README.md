## ğŸš€ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### âš›ï¸ ã‚³ã‚¢
- **TypeScript 5.9.3**  
- **React 19.2.3**  
- **Next.js 15.1.4**  

---

### â˜ï¸ ã‚¤ãƒ³ãƒ•ãƒ©
- **Cloudflare Workers**  
- **Cloudflare D1**  
- **OpenNext**  
- **Wrangler**  

---

### ğŸ—ƒï¸ ORM
- **Drizzle ORM**  
- **Drizzle Kit**  
- **Drizzle Zod**  
---

### ğŸ§© çŠ¶æ…‹ç®¡ç†
- **Zustand**  

---

### ğŸ§¾ ãƒ•ã‚©ãƒ¼ãƒ  / ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **React Hook Form**  
- **Zod**  

---

### ğŸ¨ UI / ãƒ‡ã‚¶ã‚¤ãƒ³
- **shadcn/ui**  
- **Radix UI**  
- **Tailwind CSS 4**  

---

### ğŸ› ï¸ ãƒ†ã‚¹ãƒˆ
- **Playwright**  
- **Vitest**  
- **React Testing Library**  

---

### ğŸ› ï¸ å“è³ªç®¡ç†
- **Biome**  
- **Knip**  

---

## ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰æ§‹é€ 
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®è²¬å‹™ã§åˆ†é›¢ã•ã‚Œã¦ã„ã¾ã™ã€‚

1. **UI Layer (`app/`, `components/`)**: Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨Next.js Pagesã€‚
2. **Action Layer (`**/actions.ts`)**: Server Actionsã€‚UIã¨Service Layerã®ä»²ä»‹å½¹ã€‚
3. **Service Layer (`src/db/services/`)**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€‚Drizzle ORMã‚’ä½¿ç”¨ã—ãŸDBæ“ä½œã€‚
4. **Validation Layer (`src/db/validation/`)**: Zodã«ã‚ˆã‚‹å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€‚
5. **Data Layer (`src/db/core/`)**: Drizzleã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¨æ¥ç¶šè¨­å®šã€‚

### ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ãƒ•ãƒ­ãƒ¼
```
Cloudflare Worker (Entrypoint)
    â†“
.open-next/worker.js (OpenNext Generated)
    â†“
Next.js App Router / Server Actions
    â†“
Service Layer (Drizzle ORM)
    â†“
D1 Database Access (via Binding)
```

---

## ï¿½ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
src/
â”œâ”€â”€ app/                  # Next.js App Router (ãƒšãƒ¼ã‚¸ã€Server Actions)
â”‚   â”œâ”€â”€ (home)/          # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ polls/           # åº—æ±ºã‚ï¼ˆå¤šæ•°æ±ºï¼‰æ©Ÿèƒ½
â”‚   â””â”€â”€ schedule/        # æ—¥ç¨‹èª¿æ•´æ©Ÿèƒ½
â”œâ”€â”€ components/           # å…±é€š React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (UIãƒ‘ãƒ¼ãƒ„)
â”œâ”€â”€ db/                   # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£
â”‚   â”œâ”€â”€ core/            # ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã€æ¥ç¶šè¨­å®š (drizzle.ts)
â”‚   â”œâ”€â”€ services/        # DBã‚¢ã‚¯ã‚»ã‚¹ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (ORMæ“ä½œ)
â”‚   â””â”€â”€ validation/      # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒ (Zod / drizzle-zod)
â”œâ”€â”€ hooks/                # ã‚«ã‚¹ã‚¿ãƒ  React Hooks
â”œâ”€â”€ lib/                  # å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¨­å®šãƒ»åˆæœŸåŒ– (MUI, Dayjs)
â”œâ”€â”€ stores/               # Zustand ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†
â”œâ”€â”€ types/                # å…±é€šå‹å®šç¾©
â””â”€â”€ utils/                # æ±ç”¨çš„ãªç´”ç²‹é–¢æ•° (æ—¥ä»˜, OGP, URL, Styles)
```

### é–‹ç™ºãƒ«ãƒ¼ãƒ«
- `lib` ã¯ã€Œå¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¨­å®šï¼ˆåˆæœŸåŒ–ï¼‰ã€ã®ã¿ã‚’ç½®ãã¾ã™ï¼ˆä¾‹: `lib/dayjs.ts` ã§æ—¥æœ¬èªåŒ–è¨­å®šï¼‰ã€‚
- `utils` ã¯ã€Œã‚¢ãƒ—ãƒªç‹¬è‡ªã®å‡¦ç†ï¼ˆç´”ç²‹é–¢æ•°ï¼‰ã€ã‚’ç½®ãã¾ã™ï¼ˆä¾‹: `utils/date.ts` ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå‡¦ç†ï¼‰ã€‚
- **DBæ“ä½œ**: ç›´æ¥ `app` ã‚„ `actions` ã§ `drizzle` ã‚’å©ã‹ãšã€å¿…ãš `src/db/services` çµŒç”±ã§è¡Œã„ã¾ã™ã€‚

---

## ğŸ› ï¸ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### 2. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æº–å‚™

ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ã®D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSQLiteï¼‰ã‚’ä½œæˆã—ã€ã‚¹ã‚­ãƒ¼ãƒã‚’é©ç”¨ã—ã¾ã™ã€‚

```bash
npm run db:setup
```

### 3. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

**A. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å…ˆè¡Œé–‹ç™º (é«˜é€Ÿ)**
UIã‚„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã«é©ã—ã¦ã„ã¾ã™ã€‚
â€» D1ã¸ã®å®Ÿéš›ã®ä¿å­˜ã¯è¡Œã‚ã‚Œã¾ã›ã‚“ï¼ˆãƒ¢ãƒƒã‚¯æ¨å¥¨ï¼‰ã€‚

```bash
npm run dev
# -> http://localhost:3000
```

**B. API / ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºé–‹ç™º**
Cloudflare Pages äº’æ›ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¾ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å®Ÿéš›ã«æ¥ç¶šã—ã¦å‹•ä½œç¢ºèªãŒã§ãã¾ã™ã€‚

```bash
npm run dev:cf
# -> http://localhost:8788
```

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ç®¡ç†
Drizzle Kitã‚’ä½¿ç”¨ã—ã¦ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´ã‚’ç®¡ç†ã—ã¾ã™ã€‚

```bash
# ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã‹ã‚‰ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
npx drizzle-kit generate

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ­ãƒ¼ã‚«ãƒ«DBã«é©ç”¨
npm run db:setup
```

### ãƒ‡ãƒãƒƒã‚°
```bash
# ä»»æ„ã®SQLã‚’å®Ÿè¡Œ
npm run db:query -- "SELECT * FROM polls LIMIT 5"
```

---

## ï¿½ åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run dev` | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• (Next.js) |
| `npm run dev:cf` | Cloudflare äº’æ›ã®é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• |
| `npm run build:cf` | Cloudflare å‘ã‘ã®ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ |
| `npm run deploy:prd` | æœ¬ç•ªç’°å¢ƒ (Production) ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ |
| `npm run db:setup` | ãƒ­ãƒ¼ã‚«ãƒ«DBã®ä½œæˆãƒ»åˆæœŸåŒ– |
| `npm run db:reset` | ãƒ­ãƒ¼ã‚«ãƒ«DBã®å®Œå…¨åˆæœŸåŒ– |
| `npm run check:fix` | Biome ã«ã‚ˆã‚‹ä¸€æ‹¬ã‚³ãƒ¼ãƒ‰ä¿®æ­£ (Lint, Format, Imports) |
| `npm run knip` | æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®æ¤œå‡º |
| `npm run cf-typegen` | Cloudflare ã®å‹å®šç¾©è‡ªå‹•ç”Ÿæˆ |

### é–‹ç™º
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run dev` | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• (Next.js) |
| `npm run dev:cf` | Cloudflare äº’æ›ã®é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• |
| `npm run build:cf` | Cloudflare å‘ã‘ã®ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ |
| `npm run preview` | ãƒ“ãƒ«ãƒ‰å¾Œã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼èµ·å‹• |

### ãƒ‡ãƒ—ãƒ­ã‚¤
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run deploy:stg` | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ |
| `npm run deploy:prd` | æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ |

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run db:setup` | ãƒ­ãƒ¼ã‚«ãƒ«DBã®ä½œæˆãƒ»åˆæœŸåŒ– |
| `npm run db:setup:stg` | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒDBã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— |
| `npm run db:setup:prd` | æœ¬ç•ªç’°å¢ƒDBã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— |
| `npm run db:query` | ãƒ­ãƒ¼ã‚«ãƒ«DBã¸ã®SQLã‚¯ã‚¨ãƒªå®Ÿè¡Œ |
| `npm run db:reset` | ãƒ­ãƒ¼ã‚«ãƒ«DBã®å®Œå…¨åˆæœŸåŒ– |

### ãƒ†ã‚¹ãƒˆ
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run test` | Playwright E2E ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `npm run test:ui` | Playwright UI ãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `npm run test:report` | Playwright ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º |
| `npm run test:unit` | Vitest ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `npm run test:unit:watch` | Vitest ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `npm run test:unit:ui` | Vitest UI ãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |
| `npm run test:unit:coverage` | Vitest ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ |

### ã‚³ãƒ¼ãƒ‰å“è³ª
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run lint` | Biome ã«ã‚ˆã‚‹ãƒªãƒ³ãƒˆãƒã‚§ãƒƒã‚¯ |
| `npm run lint:fix` | Biome ã«ã‚ˆã‚‹ãƒªãƒ³ãƒˆä¿®æ­£ |
| `npm run format` | Biome ã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ |
| `npm run check` | Biome ã«ã‚ˆã‚‹ä¸€æ‹¬ãƒã‚§ãƒƒã‚¯ |
| `npm run check:fix` | Biome ã«ã‚ˆã‚‹ä¸€æ‹¬ã‚³ãƒ¼ãƒ‰ä¿®æ­£ (Lint, Format, Imports) |
| `npm run knip` | æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®æ¤œå‡º |

### ãã®ä»–
| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `npm run cf-typegen` | Cloudflare ã®å‹å®šç¾©è‡ªå‹•ç”Ÿæˆ |
